---
- name: Set runner_system_dir variable
  ansible.builtin.set_fact:
    runner_system_dir: "macos"
  when: ansible_system == "Darwin"

- name: Set runner_system_dir variable
  ansible.builtin.set_fact:
    runner_system_dir: "linux"
  when: ansible_system == "Linux"

- name: Set runner_system_dir variable
  ansible.builtin.set_fact:
    runner_system_dir: "windows" #rever
  when: ansible_system == "Win32NT"

- name: Include Assert tasks
  ansible.builtin.include_tasks: common/assert.yml
  tags:
    - install
    - uninstall

- name: Include Information collection taks
  ansible.builtin.include_tasks: "{{ runner_system_dir }}/collect_info.yml"
  tags:
    - install
    - uninstall

- name: Include tasks to install dependencies
  ansible.builtin.include_tasks: "{{ runner_system_dir }}/install_deps.yml"
  when: runner_system_dir == 'linux' and runner_state|lower == "started" or runner_system_dir == 'linux' and runner_state|lower == "stopped"
  tags:
    - install

- name: Include tasks to uninstall runner
  ansible.builtin.include_tasks: "{{ runner_system_dir }}/uninstall_runner.yml"
  when: reinstall_runner or runner_state|lower == "absent"
  tags:
    - uninstall

- name: Include tasks to install runner
  ansible.builtin.include_tasks: "{{ runner_system_dir }}/install_runner.yml"
  when: runner_state|lower == "started" or runner_state|lower == "stopped"
  tags:
    - install
